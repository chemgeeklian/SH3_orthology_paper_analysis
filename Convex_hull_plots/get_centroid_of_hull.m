x = [-1.23924839 -0.68866104 -1.0459528  -0.53164816 -0.5651958  -1.38092613 ...
 -1.23747098 -1.16677213 -1.35482764 -0.51137555 -0.77513605 -1.44807255 ...
 -1.01619029 -1.66276169 -0.56438369 -1.28179204 -1.86623418 -1.88426602 ...
 -0.43157646 -0.89082509 -1.40498161 -1.32168412 -1.40069926 -1.63657594 ...
 -1.21273875 -1.8353281  -1.74537349 -1.08542323 -1.40834975 -1.37061667 ...
 -1.396716   -1.16075158 -1.17403972 -1.3454113  -1.47835016 -1.29477596 ...
 -1.03355908 -1.1231811  -1.87628114 -1.34801674 -1.16955459 -1.06866264 ...
 -0.42386004 -0.94150293 -0.97774583];

y = [0.83968449 0.63801277 1.20016026 0.84090942 0.86304474 0.85563493 ...
 0.87865353 0.88982522 0.94721293 0.64988261 1.15309262 0.8702628 ...
 0.5134728  1.24996328 0.33448017 0.93277037 1.25104427 1.24358177 ...
 0.29986149 1.02593064 0.73661321 0.7423774  0.73445493 1.4240284 ...
 0.98935527 1.22605944 1.11841083 1.20946836 0.72845119 0.73885167 ...
 1.08481598 1.27605462 0.78955728 0.81176442 0.90111685 0.93188196 ...
 1.1820457  1.13308108 0.9916712  0.72133148 0.93210852 0.44336772 ...
 0.44873112 0.3107138  0.3378585 ];

z = [ 1.84360933  1.12691152  1.25467873  0.7220642   0.47559419  1.93234396 ...
  1.87805331  1.83904922  1.94342113  0.65073919  0.7940008   1.9268527 ...
  0.65533221  1.22541785  0.58102274  1.95224142  1.39286828  1.43332887 ...
  0.19294749  0.6745764   1.77364683  0.7766608   0.87143826  1.36232197 ...
  1.88458085  1.32786572  1.1660943   1.29872394  1.70348608  1.80677891 ...
  0.89955837  1.24104238  1.73355377  1.86907983  1.89096761  1.95202446 ...
  1.25927281  0.83143842  1.3120538   1.77294457  1.86582851  1.15043902 ...
 -0.00305042  0.85545862  0.90362847];

xyz=[[-1.23924839  0.83968449  1.84360933]
 [-0.68866104  0.63801277  1.12691152]
 [-1.0459528   1.20016026  1.25467873]
 [-0.53164816  0.84090942  0.7220642 ]
 [-0.5651958   0.86304474  0.47559419]
 [-1.38092613  0.85563493  1.93234396]
 [-1.23747098  0.87865353  1.87805331]
 [-1.16677213  0.88982522  1.83904922]
 [-1.35482764  0.94721293  1.94342113]
 [-0.51137555  0.64988261  0.65073919]
 [-0.77513605  1.15309262  0.7940008 ]
 [-1.44807255  0.8702628   1.9268527 ]
 [-1.01619029  0.5134728   0.65533221]
 [-1.66276169  1.24996328  1.22541785]
 [-0.56438369  0.33448017  0.58102274]
 [-1.28179204  0.93277037  1.95224142]
 [-1.86623418  1.25104427  1.39286828]
 [-1.88426602  1.24358177  1.43332887]
 [-0.43157646  0.29986149  0.19294749]
 [-0.89082509  1.02593064  0.6745764 ]
 [-1.40498161  0.73661321  1.77364683]
 [-1.32168412  0.7423774   0.7766608 ]
 [-1.40069926  0.73445493  0.87143826]
 [-1.63657594  1.4240284   1.36232197]
 [-1.21273875  0.98935527  1.88458085]
 [-1.8353281   1.22605944  1.32786572]
 [-1.74537349  1.11841083  1.1660943 ]
 [-1.08542323  1.20946836  1.29872394]
 [-1.40834975  0.72845119  1.70348608]
 [-1.37061667  0.73885167  1.80677891]
 [-1.396716    1.08481598  0.89955837]
 [-1.16075158  1.27605462  1.24104238]
 [-1.17403972  0.78955728  1.73355377]
 [-1.3454113   0.81176442  1.86907983]
 [-1.47835016  0.90111685  1.89096761]
 [-1.29477596  0.93188196  1.95202446]
 [-1.03355908  1.1820457   1.25927281]
 [-1.1231811   1.13308108  0.83143842]
 [-1.87628114  0.9916712   1.3120538 ]
 [-1.34801674  0.72133148  1.77294457]
 [-1.16955459  0.93210852  1.86582851]
 [-1.06866264  0.44336772  1.15043902]
 [-0.42386004  0.44873112 -0.00305042]
 [-0.94150293  0.3107138   0.85545862]
 [-0.97774583  0.3378585   0.90362847]];

C = centroid(xyz)

function C = centroid(P)
k=convhulln(P);
if length(unique(k(:)))<size(P,1)
    error('Polyhedron is not convex.');
end
T = delaunayn(P);
n = size(T,1);
W = zeros(n,1);
C=0;
for m = 1:n
    sp = P(T(m,:),:);
    [null,W(m)]=convhulln(sp);
    C = C + W(m) * mean(sp);
end
C=C./sum(W);
return

end